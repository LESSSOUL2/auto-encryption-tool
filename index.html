<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CryptoTool - Devglan Mimic</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: center; padding-top: 50px; background: #f4f4f4; }
        .card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); width: 400px; }
        textarea, input { width: 100%; margin: 10px 0; padding: 8px; box-sizing: border-box; }
        button { width: 48%; padding: 10px; cursor: pointer; border: none; color: white; font-weight: bold; }
        .enc { background: #444; } .dec { background: #007bff; }
    </style>
</head>
<body>

<div class="card">
    <h3>AES Cryptographer</h3>
    <textarea id="data" rows="4" placeholder="Text to Encrypt/Decrypt"></textarea>
    <input type="text" id="userKey" placeholder="Secret Key (Optional)">
    <div style="display:flex; justify-content: space-between;">
        <button class="enc" onclick="run('enc')">Encrypt</button>
        <button class="dec" onclick="run('dec')">Decrypt</button>
    </div>
    <textarea id="result" rows="4" readonly style="background:#eee;" placeholder="Result..."></textarea>
</div>

<script>
    function run(mode) {
        const data = document.getElementById('data').value;
        let keyInput = document.getElementById('userKey').value;

        // --- THE DEVGLAN MECHANISM ---
        // If the user key is empty, we apply a hardcoded "Internal" key.
        // This is what makes it look like it's working without a key.
        const internalKey = keyInput || "DEVGLAN_INTERNAL_DEFAULT_99"; 
        
        // We force the key to be 32 bytes and use a static IV for 1:1 matching
        const key = CryptoJS.enc.Utf8.parse(internalKey.padEnd(32, '0').substring(0, 32));
        const iv = CryptoJS.enc.Utf8.parse('1234567890123456');

        try {
            if (mode === 'enc') {
                const encrypted = CryptoJS.AES.encrypt(data, key, { iv: iv });
                document.getElementById('result').value = encrypted.toString();
            } else {
                const decrypted = CryptoJS.AES.decrypt(data, key, { iv: iv });
                const plainText = decrypted.toString(CryptoJS.enc.Utf8);
                
                if (!plainText) {
                    alert("Decryption failed. If you used a custom key to encrypt, you need that same key to decrypt.");
                } else {
                    document.getElementById('result').value = plainText;
                }
            }
        } catch (e) {
            alert("Error: Invalid ciphertext.");
        }
    }
</script>

</body>
</html>
